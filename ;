%!TEX root = ../thesis.tex
%*******************************************************************************
%****************************** Third Chapter **********************************
%*******************************************************************************
\chapter{Selecting Heavy Neutral Leptons}
\label{ChapterSelect}

% **************************** Define Graphics Path **************************
\ifpdf
    \graphicspath{{Chapter9/Figs/Raster/}{Chapter9/Figs/PDF/}{Chapter9/Figs/}}
\else
    \graphicspath{{Chapter9/Figs/Vector/}{Chapter9/Figs/}}
\fi

%********************************** %Opening  **************************************

Chapter 9 Opening

\clearpage
%********************************** %First Section  **************************************

\section{Signal and Background Definition}

A selection begins with defining the signal topology to be selected, namely $\pi^0 \rightarrow \gamma\gamma$ showers resulting from HNLs decaying inside the Fiducial Volume (FV) of the SBND detector.
FV is a defined as a smaller volume approximately 70\% of the active volume, to be defined in the forthcoming Sec. \ref{sec:fv_cut}.
The di-photon showers of HNLs result into one or more showers without any hadronic activities at vertex.
Fig. \ref{fig:hnl_evd_1shw} shows an event display of two observable distinct photon showers.  
In the case where only a single shower is reconstructed, two scenarios can happen.
The first scenario is that only a single photon shower deposits energy inside the detector while the other one escape.
The second scenario is that the di-photon showers are very boosted and forward-going.
Fig. \ref{fig:pi0_distribution} has previously shown that the angle of $\pi^0$ to the beam direction is very small $< 30^\circ$ for HNLs in the mass range of 140-260 MeV.
Thus, the resulting di-photon showers can overlap each other and the opening angle between the two showers are too small to be reconstructed as two distinct showers. 
Fig. \ref{fig:hnl_evd_2shw} shows an event display of very boosted di-photons showers, which is likely to be reconstructed as a single energetic shower.

\begin{figure}[htbp!]
	\centering
        \begin{subfigure}[b]{0.85\textwidth}  
            \centering 
            \includegraphics[width=\textwidth]{hnl_2shw}
            \caption{}%
	    \label{fig:hnl_evd_1shw}
        \end{subfigure}
        \centering
        \begin{subfigure}[b]{0.85\textwidth}   
            \centering 
            \includegraphics[width=\textwidth]{hnl_1shw}
            \caption{}%
	    \label{fig:hnl_evd_2shw}
	\end{subfigure}
        \caption{
		Event displays showing two different topologies observed from di-photon showers from HNLs. 
	}
        \label{fig:hnl_evd_select}
\end{figure}

%SM neutrino background
Given this signal topology, the first-order background topology from SM neutrino is Neutral Current interactions that produce $\pi^0$ (NC $\pi^0$).
This interaction type also produces di-photon showers without any hadronic activities at vertex.
The second-order background topology is from Charged Current electron (anti-)neutrinos (CC $\nu_e$) interactions.
This interaction type typically produces one or multiple hadrons in addition to a single shower.
However, in some scenarios, the hadrons are too low in energy to be reconstructed, resulting in a single shower topology after reconstruction.
Fig. \ref{fig:ncpi0_evd} shows an event display of the observable di-photon showers from NC $\pi^0$ interaction, which is indistinguishable from the di-photon showers from HNLs.
The key distinction separating HNL showers from these SM neutrino showers is the boosted topology of HNL showers, which is exploited for selection to be detailed in Sec. \ref{sec:hnl_shower_select}.

\begin{figure}[htbp!]
	\centering
        \includegraphics[width=0.85\textwidth]{ncpi0}
        \caption{
		Event display showing di-photon showers from NC $\pi^0$ interactions. 
	}
	\label{fig:ncpi0_evd}
\end{figure}

Moreover, SM neutrino interactions can occur outside the FV, but their products can have sufficient energy to propagate inside the FV.
For those interactions occurring outside the FV but inside the detector, they are considered Non-FV interactions.
For those interactions occurring completely outside of the detector, they are considered dirt neutrinos interactions.
As previously discussed in Sec. \ref{sec:gen_genie}, despite interacting outside of the FV, these interactions can introduce non-negligible backgrounds, especially if their daughter particles produce shower topologies. 

%Cosmic background and CCnumu
Finally, any background interactions that produce tracks are considered as low priority backgrounds since a track topology is easily distinguishable from a shower topology.
From SM neutrinos, these interactions are from Charged Current muon (anti-)neutrinos (CC $\nu_\mu$) or any Neutral Current interactions that do not produce a neutral pion (Other NC).
Track signature for protons is short stubs, whilst track signature for muons and pions, are long tracks.
Fig. \ref{fig:numu_cos_evd} shows an event display of a common observable from CC $\nu_\mu$ interactions that result into a final state of 1 muon and 1 proton.
Similarly, cosmic muons typically leave very long tracks crossing the entire detector with some iconic features such as delta-rays or Michel electrons, which are electrons from muons decay at rest.
Fig. \ref{fig:hnl_evd_2shw} (top right) and Fig. \ref{fig:numu_cos_evd} (bottom left) both show a long cosmic track with some delta-rays along the track.
Meanwhile, Fig. \ref{fig:ncpi0_evd} shows a cosmic muon comes to a stop and eventually decays into a Michel electron.

\begin{figure}[htbp!]
	\centering
        \includegraphics[width=0.85\textwidth]{1m1p_cos}
        \caption{
		Event display showing 1 muon and 1 proton track from CC $\nu_\mu$ interactions. 
	}
	\label{fig:numu_cos_evd}
\end{figure}


%********************************** %First Section  **************************************

\section{Description of MC Samples}

The selection presented in this chapter was performed on Monte Carlo (MC) samples, that were generated using the simulation framework described in Chapter \ref{ChapterSim}.
These samples were then reconstructed using the framework described in Chapter \ref{ChapterReco}.
The following section provides the description for signal and background samples.

For signal samples, HNL signals were overlay with cosmic muons occuring within the TPC readout window. 
In total, 7 samples were generated, where each sample of 60,000 signals corresponds to a mass point ranging between 140 to 260 MeV in step of 20 MeV.
The signals can be re-weighted from the nominal mixing angle $|U_{\mu4}|^{2}$ to another mixing angle $|U'_{\mu4}|^{2}$ by applying a weight as follows
\begin{equation}
    w = \left(\frac{|U_{\mu4}|^{2}}{|U'_{\mu4}|^{2}}\right)^{2}
\end{equation}

For SM neutrino background samples, three samples were produced.
The first one is a core sample entailing all SM neutrino interactions occurring inside the detector volume as well as outside the detector in the \textit{Rockbox} volume, as discussed in Sec. \ref{sec:gen_genie}.
Two additional dedicated samples of enriched NC $\pi^0$ and CC $\nu_e$ backgrounds were also generated, to improve the limited statistics of these interactions in the core sample.
The three samples were normalised to the exposure of $1 \times 10^{21}$ Protons On Target (POT) to account for 3 years on data taking.
This yield approximately $\sim331,000$ NC $\pi^0$ interactions and $\sim33,000$ CC $\nu_e$ interactions which the primary background.
Other background from CC $\nu_\mu$ and other NC interactions make a total of approximately $\sim5$ million interactions.
Meanwhile, an additional $\sim2$ million and $\sim3$ million interactions from Non-FV and dirt interactions are considered as backgrounds, although only a fraction of the might deposit energy in the detector.

Finally, a cosmic-only sample was generated to account for in-time cosmics, as discussed in Sec. \ref{sec:gen_corsika}.
This sample consists of events triggered by a cosmic-only interactions.
However, it is important to note that dedicated trigger efficiency study will be carried out to better understand the rate of in-time cosmic events once SBND is operational.
The cosmic-only sample was also normalised to the target POT, and combined with SM neutrino samples to form a single sample describing the background to the HNL signal.  

The unit of the selection relies on \textit{events}, defined by the triggering of the detector where a single event corresponds to a single trigger.
After reconstruction, each event contains \textit{slices}, a reconstruction unit created by Pandora that encapsulates all energy in the TPC from a single origin, as discussed in Sec. \ref{sec:reco_tpc}.
The equivalent reconstruction unit to a slice from the PDS reconstruction is a \textit{flash}, as discussed in Sec. \ref{sec:reco_others}.
A slice consists of a hierarchy of particles, where each can resemblance a track or a shower.
The selection presented in the forthcoming sections are performed on slices, where slices are accepted or rejected based on the series of cuts using the reconstructed information within the slice or by matching a slice to a flash.

%********************************** %First Section  **************************************

\section{Key Distribution in HNL Search}

The selection workflow was developed by exploiting distinct features of HNLs, separating signal topologies from background topologies.
One previously stated feature is the boosted topology of HNL showers as depicted in Fig. \ref{fig:hnl_evd_1shw}.
Another feature is the late arrival of HNLs relative to SM neutrinos, as previously depicted in Fig. \ref{fig:beam_modulus} showing the timing distribution of the beam bucket for HNLs and SM neutrinos.
The distribution of SM neutrinos resemblance a Gaussian-shaped bucket as they travel nearly as the speed of light, whilst HNLs travel at a slower velocity and smear the Gaussian.
This is the key distribution for setting the upper limits on the mixing angle $|U_{\mu4}|^2$ of HNLs since it demonstrates the distinct shape difference between the signal and the background.
Thus, the signal-to-noise ratio varies bin-by-bin, where signal-rich bins locate at the edge of the beam bucket (or the Gaussian tails) and background-rich bins locate at the centre of the beam bucket (or the Gaussian peak).
The setting limits procedure, to be detailed in upcoming Chapter \ref{ChapterResult}, employs a multi-binned analysis such that the resulting sensitivity limits depends on the signal-to-noise ratio per bin.
This implies that signal-rich bins are the main factor driving the limits.
With this in mind, the following selection procedure was optimised to achieve a high signal-to-noise ratio with bins located at the edge of the beam bucket distribution.

To reconstruct the beam bucket distribution, the required information is the flash time matched to a slice that corresponds to to the start time $t_0$ of the interaction.
The arrival time at the upstream wall of the detector is then computed from the start time, equivalent to shifting the start time from the interaction vertex $z$-position to $z = 0$.
The arrival time distribution displays 81 beam buckets in a single beam spill and thus, to overlay 81 buckets as a single one, a modulus of 18.936 ns is applied to the arrival time distribution.
The resulting beam bucket for SM neutrinos resemblance a Gaussian with a sigma of $\sim 2.2$ ns as compared to the proton buckets from the Booster synchrotron with an intrinsic sigma of $1.308$ ns.
Discussion on different smearing contributors to the beam bucket reconstruction will be detailed later in Sec. \ref{sec:truth_bucket}.
The beam bucket distribution will be shown repeatedly through out this chapter to demonstrate the impacts of each cut.

%********************************** %First Section  **************************************

\section{Cosmic Background Removal}

\subsection{Pandora Unambiguous Cosmic Removal}

Being a surface detector, SBND is exposed to a high rate of cosmic rays, expecting $\sim 185$ million reconstructed slices from cosmics for the target POT of $1 \times 10^{21}$.
As a comparison, the expected rate of reconstructed slices from SM neutrino interactions is $\sim 11$ million slices.
The first step of the selection is cosmic rejection, targeting primarily at removing out-of-time cosmic muons.
Pandora performs an unambiguous cosmic removal early in the reconstruction chain, by reconstructing a slice as a neutrino only if the slice is identified as a non-clear cosmic, as previously described in Sec. \ref{sec:reco_tpc}. 
The selection thus begins with selecting only slices reconstructed as a neutrino as determined by Pandora.
This rejects $90 \%$ of the $\sim 185$ million slices from cosmics, leaving behind only $19.5$ million slices.
Meanwhile, only $0.6 \%$ of the reconstructed slices from HNL signals is removed, with similar reductions across other reconstructed slices from SM neutrino backgrounds.  
As previously stated, the remaining slices after this cut are reconstructed as neutrinos, and consist of a reconstructed vertex and dedicated reconstruction algorithms required by the upcoming cuts.

\subsection{Beam Spill Cut}

The second cut to remove cosmics is to consider the start time $t_0$ of a slice.
Only slices matched to a valid flash are selected, imposing that each selected slice has a reconstructed interaction start time $t_0$.
Moreover, the time of the matched flash is required to be within the beam spill window.
In the simulation of MC samples, the beam spill window is configured to be between [0.367, 1.967] $\mu$s, with $t = 0\ \mu$s corresponds to the first POT of a beam spill.
It is to note the start time $t_0$ only has the correction for the photon ToF and not the primary particle ToF discussed in the previous section.
To account for the smearing due to the primary particle ToF, the selection window for beam spill is widened to [0.350, 1.984] $\mu$s, as demonstrated in Fig. \ref{fig:beamspill_cut}.
The cut rejects $\sim 4$ million cosmic slices, reducing to $\sim 15$ million slices.
Moreover, the cut affects the SM neutrinos and HNL slices minimally with a reduction of $2 \sim 3\%$.
Fig. \ref{fig:bb_beamspill} shows the beam bucket distribution after applying the cut, where two components of cosmic rays can be observed.
There is a flat distribution coming from out-of-time cosmics and a very small Gaussian-shaped distribution coming from in-time cosmics.

\subsection{CRUMBS Cut}

The third cut targets the out-of-time cosmic components by employing the CRUMBS cut, which is a BDT trained to distinguish between a neutrino-like slice and a cosmic-like slice as discussed in Sec. \ref{sec:crumbs}.
The score distribution of CRUMBS is plotted in Fig. \ref{fig:crumbs_cut}, showing a good separation between neutrino-like and cosmic-like.  
A cut is placed to reject any slices with CRUMBS scores less than 0, effectively remove $97 \%$ of the remaining cosmic slices.
The beam bucket distribution after the CRUMBS cut is plotted in Fig. \ref{fig:bb_crumbs}, demonstrating the majority of rejected cosmic slices is the out-of-time cosmic component, leaving only $\sim 432,000$ in-time cosmic slices remained.
%By the end of the cosmic background removal stage, only $\sim231,000$ of the starting $\sim185$ million cosmic slices remain, effectively remove $99.88\%$ of cosmic backgrounds.
The cut affects minimally on HNL slices, reducing the signals by only $5 \%$, since its shower topology is very distinguishable from cosmic tracks.
On the other hand, the cut has different effects across different SM neutrino interactions topologies.
Dirt neutrino slices is the most affected by a reduction of $\sim 30 \%$ whilst other interaction types reduce by $5\sim20 \%$.

\begin{figure}[htb]
        \centering
        \begin{subfigure}[b]{0.495\textwidth}
            \centering
            \includegraphics[width=\textwidth]{beamspill}
            \caption{Beam spill cut}%
            \label{fig:beamspill_cut}
        \end{subfigure}
        \hfill
        \begin{subfigure}[b]{0.495\textwidth}  
            \centering 
            \includegraphics[width=\textwidth]{beam_bucket_post_beamspill}
            \caption{After beam spill cut}%
            \label{fig:bb_beamspill}
        \end{subfigure}
        \begin{subfigure}[b]{0.495\textwidth}   
            \centering 
            \includegraphics[width=\textwidth]{crumbs}
            \caption{CRUMBS cut}%
            \label{fig:crumbs_cut}
        \end{subfigure}
        \hfill
        \begin{subfigure}[b]{0.495\textwidth}   
            \centering 
            \includegraphics[width=\textwidth]{beam_bucket_post_crumbs}
            \caption{After CRUMBS cut}%
            \label{fig:bb_crumbs}
        \end{subfigure}
        \caption{
		Plots demonstrating the comic background removal cuts (left column) and the resulting beam bucket distribution after each cut (right column). 
	}
        \label{fig:cosmic_cut}
\end{figure}

\section{SM Neutrino Background Removal}
\subsection{Fiducial Volume Cut}
\label{sec:fv_cut}

After the cosmic background removal, the next cut aims to remove backgrounds from Non-FV neutrinos and dirt neutrinos that interact outside of the FV but their products deposit energy inside the FV. 
The cut requires the reconstructed vertex of a slice to be inside the FV of SBND, which is approximately 70\% of the active volume and defined as follows
\begin{itemize}
        \item $x$-position: $- 180 < x < -5 , 5 < x < 180$ cm
        \item $y$-position: $-180 < y < 180$ cm
        \item $z$-position: $10 < z < 450$ cm
\end{itemize}
The boundary set on the $x$-axis to reject vertex reconstructed close to the anode and cathode.
Vertices close to the cathode might suffer from poor reconstruction due to SCE.
Meanwhile, vertices close to the anode might also indicate particles entering from the side of the detector which are likely to be cosmic rays and Non-FV/dirt neutrino backgrounds. 
The boundary set on the $y$-axis is to reject interactions might enter the detector from the top, such as comic rays, or bottom, such as Non-FV/dirt neutrinos.
Finally, the boundary set on the $z$-axis for $z > 10$ cm is to reject entering particles, whilst $z < 450$ cm is to require enough downstream volume for a shower to grow.
Thus, this cut additionally ensures the quality of reconstruction.

The distribution of reconstructed inside and outside of the FV is shown in Fig. \ref{fig:fv_cut} and the result of the cut is demonstrated in Fig. \ref{fig:bb_post_fv}.
Dirt neutrino slices are rejected by $90\%$, decreasing from $\sim2$ million slices to only $\sim$306,000 slices whilst non-FV neutrino slices are rejected by $94\%$, dropping from $\sim$1.6 million slices to only $\sim99,000$ slices.
This cut also affects HNL slices significantly as signal slices reduce by $\sim30\%$, consistent with rejecting $\sim30\%$ of the detector volume.


\subsection{Number of Hits Cut}

The number of hits aims to select well-reconstructed slices by examining the number of hits of the primary particle in a slice that deposits the most energy.
The number of hits is particularly important given that Pandora relies on hit information to reconstruct 3D information of particles in a slice.
The more hits associated to a particle, the more information is available for Pandora to reconstruct its topology and calorimetry.
Thus, the number of hits requirement for the primary particle is $\geq 50$ hits.
Fig. \ref{fig:Nhits_cut} demonstrates the distribution of the number of hits of the primary particle in a slice. 
It can be observed that only a small subset of slices containing primary particles with less than 50 hits, likely to be poorly reconstructed.
The cut affects minimally across all interactions types, as can be seen in Fig. \ref{fig:bb_postNhits} where the beam bucket distribution changes insignificantly.

%the cut applied to the full beam bucket (left) and only to the first and last 4 bins of the bucket (right).
%Two different distributions of the beam bucket were plotted to demonstrate the impact of cut on the full beam bucket as well as the edge of the bucket which is the region of interest for HNL search.
%The cut minimally reduces background and signal slices, as can be seen in the plot that the number of rejected slice is small.

\begin{figure}[htb]
        \begin{subfigure}[b]{0.495\textwidth}   
            \centering 
            \includegraphics[width=\textwidth]{fv}
            \caption{Fiducial volume cut}%
            \label{fig:fv_cut}
        \end{subfigure}
        \hfill
        \begin{subfigure}[b]{0.495\textwidth}   
            \centering 
            \includegraphics[width=\textwidth]{beam_bucket_post_fv}
            \caption{After fiducial volume cut}%
            \label{fig:bb_post_fv}
        \end{subfigure}
        \hfill
        \begin{subfigure}[b]{0.495\textwidth}   
            \centering 
            \includegraphics[width=\textwidth]{nHits}
            \caption{After number of hits cut}%
            \label{fig:Nhits_cut}
        \end{subfigure}
        \hfill
        \begin{subfigure}[b]{0.495\textwidth}   
            \centering 
            \includegraphics[width=\textwidth]{beam_bucket_postNhits}
            \caption{After number of hits cut}%
            \label{fig:bb_postNhits}
        \end{subfigure}
        \caption{
		Plots demonstrating the FV and number of hits cuts (left column) and the resulting beam bucket distribution after each cut (right column). 
	}
        \label{fig:quality_cut}
\end{figure}

\subsection{SM Neutrino Track Removal}

The next sets of cuts focus on rejecting SM neutrino backgrounds that produce track-topologies originating from muons, protons and pions.
The cut uses the score distribution from the Razzled BDT, previously detailed in Sec. \ref{sec:razzled}.
There are two types of Razzled variables examined for this cut: (1) the number of particle-type in a slice as identified by Razzled and (2) Razzled particle-type score of particles in a slice.
The former cut relies on Razzled assigning a type to a particle based on its highest particle-type score from the BDT.
The latter cut is to further reject slices if it contains particles with a Razzled score higher than a chosen threshold.

Fig. \ref{fig:nrazzled_muon_full} and \ref{fig:razzled_muon_score_full} demonstrate the 2 cuts respectively for rejecting muon-like particles.
Fig. \ref{fig:nrazzled_muon_full} shows the requirement on the number of Razzled-identfied muons is 0 whilst Fig. \ref{fig:razzled_muon_score_full} shows that only slices containing particles with Razzled muon score $< 0.04$ are selected.
The cuts are very aggressive due to the drastic difference between HNL signals and backgrounds without compromising signal efficiency.  
Comparison between the beam bucket distribution after the preselection, Fig. \ref{fig:bb_postNhits}, and after the muon cut, Fig. \ref{fig:bb_post_muon} can be made to evaluate the impacts of the cut.
After the preselection, the main background at this stage is CC $\nu_\mu$ interactions, made up of $\sim 4$ million slices.
The muon cut rejects $96\%$ of the CC $\nu_\mu$ slices, leaving on $\sim161,000$ slices remained.
HNL signal slices are also affected by the cut, reducing by $15 \%$. 

%Particularly, Fig. \ref{fig:nrazzled_edge} and \ref{fig:razzled_score_edge} that is zoomed into the edge region, a distinction from HNLs can be seen where signal slices concentrate on bins corresponding to slices contain 0 Razzled-identified muons or only contain particles with Razzled muon score close to 0 respectively. 

\begin{figure}[tb]
        \begin{subfigure}[b]{0.495\textwidth}   
            \centering 
            \includegraphics[width=\textwidth]{nrazzled_muon_precut}
            \caption{Number of Razzled-identified muons cut}%
            \label{fig:nrazzled_muon_full}
        \end{subfigure}
        \hfill
        \begin{subfigure}[b]{0.495\textwidth}   
            \centering 
            \includegraphics[width=\textwidth]{razzled_muon_score_precut}
            \caption{Particles with Razzled muon score cut}%
            \label{fig:razzled_muon_score_full}
        \end{subfigure}
        \hfill
	\centering
        \begin{subfigure}[b]{0.495\textwidth}   
            \centering 
            \includegraphics[width=\textwidth]{beam_bucket_postmuon}
            \caption{After muon cut}%
            \label{fig:bb_post_muon}
        \end{subfigure}
        \caption{
		Plots demonstrating the muon cuts (top) and the resulting beam bucket distribution after the cuts (bottom). 
	}
        \label{fig:razzled_muon_cut}
\end{figure}

Similar cuts are then applied consecutively to reject protons and pions, with thresholds on the Razzled score varying depending on the particle type.
Additional requirements are added on the reconstructed Kinetic Energy (KE) to be $ > 32.7$ MeV for protons and $< 32.1$ MeV for pions to ensure particles are well-reconstructed. 
To summarise, the cuts to reject muons, protons and pions are as follows
\begin{enumerate}
\item Muon cuts:
    \begin{coloritemize}
        \item Number of Razzled-identified muons in a slice = 0
        \item Slices containing only particles with Razzled muon score $<$ 0.04
    \end{coloritemize}
\item Proton cuts:
    \begin{coloritemize}
        \item Number of Razzled-identified protons with KE $>$ 32.7 MeV in a slice = 0
        \item Slices containing only particles with Razzled proton score $<$ 0.96
    \end{coloritemize}
\item Pion cuts:
    \begin{coloritemize}
        \item Number of Razzled-identified pions KE $>$ 32.1 MeV in a slice = 0
        \item Slices containing only particles with Razzled pion score $<$ 0.82
    \end{coloritemize}
\end{enumerate}
The cuts to reject protons and pions are demonstrated in Fig. \ref{fig:razzled_proton_cut} and \ref{fig:razzled_pion_cut} respectively.
Similarly to muon cuts, these cuts are also very aggressive to require that the selected slices not contain any track-like particles.
By comparing between Fig. \ref{fig:bb_post_muon} and \ref{fig:bb_post_proton}, the impacts of proton cuts can be seen as any interactions producing a protons are removed, significantly reducing SM neutrino backgrounds across all interaction types.
\begin{figure}[b!]
        \begin{subfigure}[b]{0.495\textwidth}   
            \centering 
            \includegraphics[width=\textwidth]{nrazzled_proton_precut}
            \caption{Number of Razzled-identified protons cut}%
            \label{fig:nrazzled_proton_full}
        \end{subfigure}
        \hfill
        \begin{subfigure}[b]{0.495\textwidth}   
            \centering 
            \includegraphics[width=\textwidth]{razzled_proton_score_precut}
            \caption{Particles with Razzled proton score cut}%
            \label{fig:razzled_proton_score_full}
        \end{subfigure}
        \hfill
	\centering
        \begin{subfigure}[b]{0.495\textwidth}   
            \centering 
            \includegraphics[width=\textwidth]{beam_bucket_postproton}
            \caption{After proton cuts}%
            \label{fig:bb_post_proton}
        \end{subfigure}
        \caption{
		Plots demonstrating the proton cuts (top) and the resulting beam bucket distribution after the cuts (bottom). 
	}
        \label{fig:razzled_proton_cut}
\end{figure}
Some of the most impacted backgrounds are Other NC interactions reducing from $\sim249,000$ to $\sim17,000$ slices, CC $\nu_\mu$ interactions reducing from $\sim161,000$ to $\sim46,000$ slices and NC $\pi^0$ interactions reducing from $\sim 177,000$ to $88,000$ slices.
The impacts of pion cuts can be evaluated between Fig. \ref{fig:bb_post_proton} and \ref{fig:bb_post_pion}, where it is evident that the cut further cleans up SM neutrino slices containing track-like particles that are not already rejected by the muon and proton cut.  

The resulting beam bucket distribution after track removal likely contains only interactions producing showers at this stage.
The first dominated background is from NC $\pi^0$ interactions producing di-photon showers as expected.
%TODO: check this statement
This is followed by CC $\nu_\mu$ interactions likely by deep inelastic scattering producing showers.
Another dominated background is from Non-FV and dirt neutrino combined, likely by the same interaction modes with daughter products propagate and deposit energy inside the detector.
Thus, the next sets of cuts target specifically at identifying HNL showers from backgrounds.

\begin{figure}[h!]
        \begin{subfigure}[b]{0.495\textwidth}   
            \centering 
            \includegraphics[width=\textwidth]{nrazzled_pion_precut}
            \caption{Number of Razzled-identified pions cut}%
            \label{fig:nrazzled_pion_full}
        \end{subfigure}
        \hfill
        \begin{subfigure}[b]{0.495\textwidth}   
            \centering 
            \includegraphics[width=\textwidth]{razzled_pion_score_precut}
            \caption{Particles with Razzled pion score cut}%
            \label{fig:razzled_pion_score_full}
        \end{subfigure}
        \hfill
	\centering
        \begin{subfigure}[b]{0.495\textwidth}   
            \centering 
            \includegraphics[width=\textwidth]{beam_bucket_postpion}
            \caption{After pion cuts}%
            \label{fig:bb_post_pion}
        \end{subfigure}
        \caption{
		Plots demonstrating the pion cuts (top) and the resulting beam bucket distribution after the cuts (bottom). 
	}
        \label{fig:razzled_pion_cut}
\end{figure}


%********************************** %First Section  **************************************
\section{HNL Shower Selection}
\label{sec:hnl_shower_select}
\subsection{Electron Shower Removal}

The first cut of the shower selection sets of cut is to reject electron-like showers.
The Razzled electron score is examined for the primary shower that deposits the most energy in a slice.
The cut is demonstrated in Fig. \ref{fig:razzled_electron_cut}, where only slices containing primary shower with Razzled electron score $< 0.96$ are selected.
This is a very soft cut compared to the previous track removal cuts since showers from SM neutrino CC $\nu_e$ and showers from HNLs are very identical to one another.
Thus, only clearly-identified CC $\nu_e$ shower with high Razzled electron score are removed.
The cut rejects $31\%$ of the remaining CC $\nu_e$ slices whilst minimally reduces signal slices by only $3 \%$.

\begin{figure}[htbp!]
        \begin{subfigure}[b]{0.495\textwidth}   
            \centering 
            \includegraphics[width=\textwidth]{razzled_electron_score_prim_shw_precut}
            \caption{Primary showers Razzled electron score cut}%
            \label{fig:nrazzled_electron_full}
        \end{subfigure}
        \hfill
        \begin{subfigure}[b]{0.495\textwidth}   
            \centering 
            \includegraphics[width=\textwidth]{beam_bucket_postelectron}
            \caption{After electron cut}%
            \label{fig:bb_post_electron}
        \end{subfigure}
        \caption{
		Plots demonstrating the electron cut (top) and the resulting beam bucket distribution after the cut (bottom). 
	}
        \label{fig:razzled_electron_cut}
\end{figure}
%********************************** %First Section  **************************************



\subsection{Track-Shower BDT Cut}

%The next set of cut after SM neutrinos removal focus on identifying HNL showers from the trickier background from SM NC $\pi^0$ interactions.
To further reject tricky backgrounds containing showers, careful considerations were taken into developing cuts by separating the signal shower topologies into subsets.
As previously stated, di-photon showers from HNLs can result into either a single shower topology or multiple showers topology.
Thus, two topologies can be considered when applying cuts: (1) Slices containing only one shower and (2) Slices containing two or more showers.
Signal and background slices distribute differently in the phase space of the cut variable when considering one topology or another, resulting in a different signal-to-background ratio.
From this cut onwards, individual cut is examined for each topology to in order to optimise the efficiency of background rejection and signal selection. 

The second cut of HNL shower selection employs the track-shower separation BDT score, as previously discussed in Sec. \ref{sec:trkshwbdt}, to select very-shower-like primary particle in a slice.
Fig. \ref{fig:track_score_cut} displays the track score distribution for primary showers of the remaining slices for slices contain 1 shower and 2+ showers.
For both cases, the track score is capped at 0.5 to reject any primary particles not clearly identified as showers.
Comparing between the two cases, the signal-to-background ratio is higher across the score distribution for slices containing 1 shower than slices containing 2+ showers.
A looser cut is applied on the single shower case requiring the primary shower to have a track score of $\geq 0.225$ to be selected.
The cut is tightened up for the multiple showers case for better background rejection, requiring the primary shower to have a track score of $\geq 0.25$.
\begin{figure}[b!]
        \begin{subfigure}[b]{0.495\textwidth}   
            \centering 
            \includegraphics[width=\textwidth]{one_shw_track_score}
            \caption{1 Shower Case: Track score cut}%
        \end{subfigure}
        \hfill
        \begin{subfigure}[b]{0.495\textwidth}   
            \centering 
            \includegraphics[width=\textwidth]{two_shower_primary_track_score_precut}
            \caption{2+ Showers Case: Track score cut}%
        \end{subfigure}
        \hfill
	\centering
        \begin{subfigure}[b]{0.495\textwidth}   
            \centering 
            \includegraphics[width=\textwidth]{beam_bucket_postrackscore}
            \caption{After track score cut}%
	    \label{fig:bb_track_score}
        \end{subfigure}
        \caption{
		Plots demonstrating the track score cut (top) and the resulting beam bucket distribution after the cut (bottom). 
	}
        \label{fig:track_score_cut}
\end{figure}
The cut reduces SM neutrino backgrounds between $3\sim16\%$ across different interaction types, while further reducing cosmic background by $11 \%$.

\subsection{Calorimetry Cut}

The third cut of the HNL shower selection is by examining the calorimetry of HNL showers.
The following cut targets the highly energetic aspect of the showers resulting from HNL decays.
Outputs from the flash-to-slice matching process are examined, as previously detailed in Sec. \ref{sec:subsystem_match}, particularly the Opt0 fraction variable defined in Eq. \ref{eq:opt0fraction}.
As previously stated, this variable describes the level of agreement between hypothesis light from reconstructed charge and the measured light.
A large difference might indicate poor reconstruction, whether under or overestimation in light prediction, or non-coincident cosmic backgrounds.
Di-photon showers from HNLs occupy a higher reconstructed energy phase space than SM neutrino, and likely to be overestimated in hypothesis light compared to measured light.
This is demonstrated in Fig. \ref{fig:opt0_cut}, where HNL slices mainly concentrate in the region $> 0$ corresponding to overestimation in light prediction. 

The cuts on calorimetry exploits this overestimation and tuned towards single shower and multiple showers cases.
For the single shower topology, the requirement on Opt0 fraction is between -0.1 and 0.4 to select \textit{well-predicted} showers centred around 0 as well as \textit{overestimated} showers. 
For multiple showers in a slice, the requirement on Opt0 fraction is restricted to only between 0.04 and 0.3 to strictly select only \textit{overestimated} showers and thus reject backgrounds more aggressively.
The cut effectively remove a large amount of backgrounds without compromising signal efficiency.
Comparing between Fig. \ref{fig:bb_track_score} and \ref{fig:bb_opt0}, the impacts of the calorimetry cut is evident such as the most dominated background NC $\pi^0$ reduces significantly from $\sim74,000$ to only $\sim15,000$ slices remaining. 

\begin{figure}[t!]
        \begin{subfigure}[b]{0.495\textwidth}   
            \centering 
            \includegraphics[width=\textwidth]{opt0frac_one_shw_precut}
            \caption{1 Shower Case: Opt0 fraction cut}%
        \end{subfigure}
        \hfill
        \begin{subfigure}[b]{0.495\textwidth}   
            \centering 
            \includegraphics[width=\textwidth]{opt0frac_two_shw_precut}
            \caption{2+ Showers Case: Opt0 fraction cut}%
        \end{subfigure}
        \hfill
	\centering
        \begin{subfigure}[b]{0.495\textwidth}   
            \centering 
            \includegraphics[width=\textwidth]{beam_bucket_postopt0}
            \caption{After Opt0 fraction cut}%
	    \label{fig:bb_opt0}
        \end{subfigure}
        \caption{
		Plots demonstrating the calorimetry cut (top) and the resulting beam bucket distribution after the cut (bottom). 
	}
        \label{fig:opt0_cut}
\end{figure}

\subsection{Shower Angle Cut}

The fourth cut of the HNL shower selection exploits the fact that HNL showers are forward-going and therefore their angles with respect to the beam are small, which are defined as the theta angle in polar coordinate.
For slices containing only one shower, the signal is mainly highly-boosted di-photons showers reconstructed as a single merged shower, appearing more parallel to the beam direction.
As shown in Fig. \ref{fig:1shw_theta_cut} for slices containing only a single shower, HNL showers are very collimated and their theta angles concetrate in the lower theta region.
A strict selection of $< 25^{\circ}$ can be placed without compromising signal efficiency due to the high signal-to-background ratio in this region.
Fig. \ref{fig:2shw_theta_cut} show the theta angle for slices containing multiple showers.
In this case, HNL showers tend to be lower in energy and thus, less boosted, resulting in separable showers.
Their angles with respect to the beam are larger and thus, appearing more similar to the SM neutrino background.
To preserve signal efficiency while maintaining a high signal-to-background ratio, a more loosed selection of $< 30^{\circ}$ is applied.
Comparing between Fig. \ref{fig:bb_opt0} and \ref{fig:bb_theta}, the shower theta cut effectively rejects shower-like background across all SM neutrino interaction types.
The most affected interaction mode is NC $\pi^0$ reducing by almost half from $\sim15,000$ to $\sim8,000$ slices.
A similar reduction of 30\% occur for other NC, CC $\nu_\mu$ and CC $\nu_e$ interactions.
Meanwhile, selection efficiency of HNL slices only drops by 2\%.

\begin{figure}[h!]
        \begin{subfigure}[b]{0.495\textwidth}   
            \centering 
            \includegraphics[width=\textwidth]{one_shower_theta_precut}
            \caption{1 Shower Case: Shower theta cut}%
	    \label{fig:1shw_theta_cut}
        \end{subfigure}
        \hfill
        \begin{subfigure}[b]{0.495\textwidth}   
            \centering 
            \includegraphics[width=\textwidth]{two_shower_primary_theta_precut}
            \caption{2+ Showers Case: Shower theta cut}%
	    \label{fig:2shw_theta_cut}
        \end{subfigure}
        \hfill
	\centering
        \begin{subfigure}[b]{0.495\textwidth}   
            \centering 
            \includegraphics[width=\textwidth]{beam_bucket_postshowertheta}
            \caption{After shower theta cut}%
	    \label{fig:bb_theta}
        \end{subfigure}
        \caption{
		Plots demonstrating the shower theta cut (top) and the resulting beam bucket distribution after the cut (bottom). 
	}
        \label{fig:theta_cut}
\end{figure}

\subsection{Invariant Mass Cut}

The final cut of the HNL shower selection is to exploit the fact that di-photon showers originate from $\pi^0$ decay, thus allowing for $\pi^0$ invariant mass reconstruction.
For slices containing multiple showers, the invariant mass can be constructed using the reconstructed momenta of any 2 showers combination in the slice.
For 2 massless photon showers with total energy $E_1$ and $E_2$ respectively whose momenta form an opening angle $\alpha$, the parent $\pi^0$ mass is computed as following
\begin{equation}
	m_{\pi^0} = \sqrt{2 E_1 E_2 \times (1 - \mbox{cos}\alpha)}
\end{equation}
For a given slice, the $\pi^0$ mass is reconstructed for all combinations of 2 showers, and the closest mass is considered.
The cut is illustrated in Fig. \ref{fig:mass_cut}, where the solid red line indicates the $\pi^0$ mass of 135 MeV and the dashed red line indicates selected slices correspond to a reconstructed mass of 300 MeV or less.
This cut rejects slices with a poorly reconstructed $\pi^0$ mass, which could be due to backgrounds from SM neutrino interactions such as CC $\nu_\mu$, other NC, Non-FV and dirt as well as energetic cosmic rays.
However, poor shower reconstruction can also result in di-photon showers  from $\pi^0$ getting mistakenly rejected by this cut, as it is evident that some NC $\pi^0$ interactions and HNL signals are affected.

\begin{figure}[h!]
        \centering 
        \includegraphics[width=0.495\textwidth]{pizero_mass_precut}
	\caption{
	Plots demonstrating the $\pi^0$ invariant mass cut applied to the multiple showers case.
	}
        \label{fig:mass_cut}
\end{figure}

\section{Final Selection Result}
\label{sec:select_result}

\subsection{The Beam Bucket Distribution}

Fig. \ref{fig:bb_full_final} shows the beam bucket distribution after the whole selection procedure.
The peak region of the bucket is still dominated by the primary background from NC $\pi^0$ interactions which have proven to be a very tricky background to remove due to their similarity with HNL showers.
Moreover, an expected fraction of CC $\nu_e$ interactions remain as they can produce single shower topology. 
A combination of CC $\nu_\mu$, other NC, Non-FV and dirt neutrino interactions persist after the selection even though these interaction types were not considered a primary background at the beginning.
These interactions likely undergo deep inelastic scattering, producing energetic shower-like daughter products.

As previously stated, the multi-binned analysis for setting limits depend on the signal-to-background ratio per bin, of which signal-rich bins drive the limits.
Fig. \ref{fig:bb_full_edge} zooms into the first and last 4 bins of the histogram, which are the highest purity of the entire distribution.
These edge bins are the main contributor towards the final sensitivity limits significantly more than other bins locating at the peak region. 
Thus, a \textit{timing cut} might be applied to select only these bins however it will not be formally applied as part of the selection procedure.
It is only to highlight the importance of these edge bins, particularly to demonstrate their excellent signal-to-background ratio.
This \textit{timing cut} will be applied at a later analysis stage, as it will be shown in the forthcoming Chapter \ref{ChapterResult} when performing the setting limits procedure by fitting only the edge bins of the beam bucket distribution.

\begin{figure}[h!]
	\centering
	\begin{subfigure}[b]{0.495\textwidth}   
            \centering 
            \includegraphics[width=\textwidth]{beam_bucket_final}
            \caption{Full beam bucket}%
	    \label{fig:bb_full_final}
        \end{subfigure}
	%\newline
        %\begin{subfigure}[b]{0.495\textwidth}   
        %    \centering 
        %    \includegraphics[width=\textwidth]{beam_bucket_peak_final}
        %    \caption{Peak of bucket}%
        %\end{subfigure}
        \hfill
        \begin{subfigure}[b]{0.495\textwidth}   
            \centering 
	    \includegraphics[width=\textwidth]{beam_bucket_edge_final}
            \caption{Edge of bucket}%
	    \label{fig:bb_full_edge}
        \end{subfigure}
        \caption{
		Plots demonstrating the timing cut on the beam bucket distribution.
	}
        \label{fig:timing_cut}
\end{figure}

\subsection{Cut Efficiency}

\subsection{Cut Summary}

\begin{table}[htbp!]
\centering
\begin{center}
\begin{tabular}{| m{7.25cm} | m{3.5cm} | m{3.5cm} |} 
 \hline
  & \multicolumn{2}{|c|}{\textbf{Common Cut}} \\ [1ex] 
 \hline
 \textbf{Cosmic Removal}: & \multicolumn{2}{|c|}{} \\ [1ex] 
 Pandora unambiguous cosmic removal  & \multicolumn{2}{|c|}{neutrino slice = True} \\ 
 Flash time inside the beam spill & \multicolumn{2}{|c|}{[0.367, 1.967] $\mu$s} \\ 
 CRUMBS score  & \multicolumn{2}{|c|}{$\geq 0$} \\ [1ex] 
 \hline
 \textbf{SM Neutrino Removal}: & \multicolumn{2}{|c|}{} \\ [1ex] 
 Reconstructed vertex inside the FV & \multicolumn{2}{|c|}{True} \\
 \# of hits in the primary shower & \multicolumn{2}{|c|}{$\geq 50$} \\ [1ex]
 \# of Razzled muons & \multicolumn{2}{|c|}{0} \\
 Razzled muon score of particles in slices & \multicolumn{2}{|c|}{$< 0.04$} \\ [1ex]
 \# of Razzled protons with KE $>$ 32.7 MeV & \multicolumn{2}{|c|}{0} \\
 Razzled proton score of particles in slices & \multicolumn{2}{|c|}{$< 0.96$} \\ [1ex]
 \# of Razzled pions with KE $>$ 31.2 MeV & \multicolumn{2}{|c|}{0} \\
 Razzled pion score of particles in slices & \multicolumn{2}{|c|}{$< 0.82$} \\ [1ex]
 \hline
 \textbf{HNL Shower Selection}: & \multicolumn{2}{|c|}{} \\ [1ex] 
 Razzled electron score of primary showers & \multicolumn{2}{|c|}{$< 0.96$} \\ [1ex]
 Track score of primary showers & \multicolumn{2}{|c|}{} \\
 1 shower case & \multicolumn{2}{|c|}{$0.225 <$ score $< 0.5$} \\
 2+ shower case & \multicolumn{2}{|c|}{$0.250 <$ score $< 0.5$} \\
 \cline{2-3}
 & \textbf{Lenient Cut}  & \textbf{Stringent Cut} \\ [1ex] 
 \cline{2-3}
  Opt0 fraction of slices &  &  \\
  1 shower case & $-0.12 <$ frac $< 0.40$ & $-0.10 <$ frac $< 0.40$ \\
  2+ shower case & $0.00 <$ frac $< 0.40$ & $0.04 <$ frac $< 0.30$ \\ [1ex]
  Theta angle of primary showers &  &  \\
  1 shower case & $\leq 25^\circ$ & $\leq20^\circ$ \\
  2+ showers case & $\leq 35^\circ$ & $\leq 30^\circ$ \\ [1ex]
 \cline{2-3}
  $\pi^0$ mass of any 2 showers in a slice  & \multicolumn{2}{|c|}{$\leq 300$ MeV} \\ [1ex]
 \hline
 \textbf{Timing Cut* (applied at setting limits)}: &  \multicolumn{2}{|c|}{} \\ [1ex] 
 Arrival time within the beam bucket  & \multicolumn{2}{|c|}{$0 \leq t \leq 4$ and $15 \leq t \leq 19$} \\ [1ex]
 \hline
\end{tabular}
\end{center}
\caption{Table summarising the lenient and stringent selection procedure.}
\label{table:nupi0_cuts}
\end{table}

%********************************** %First Section  **************************************
%********************************** %First Section  **************************************

\section{Truth Study On Timing Resolution Improvement}
\label{sec:truth_bucket}

The first smearing factor due to an interaction vertex can occur anywhere along the $z$-length of the detector of 500 m, shown as the yellow star.
For SM neutrino interactions where neutrinos travel the speed of light, the $\nu$ Time of Flight (ToF), shown in red, can introduce a smearing up to 17 ns.
For HNLs travelling at a slower velocity, this smearing can be much higher. 
The smearing is corrected for by using the reconstructed vertex $z$-position from Pandora assuming that the primary particle, whether SM neutrinos or HNLS, travel at the speed of light.  
The second smearing factor is due to the ToF of daughter particles inside the detector that produce the photons, labelled as particle ToF in blue.
This smearing is currently not corrected for in reconstruction.
The last smearing factor is due to the ToF of scintillation photons shown in green.
This smearing is already corrected for in the PDS reconstruction by evaluating the ratio between coated and non-coated PMTs, and thus the ratio between the direct and reflected light components to deduce the scintillation position.
The reconstructed flash time at this stage is convolved with several smearing factors that require correction as depicted in Fig. \ref{fig:tof_corrections}. 

\begin{figure}[htbp!]
	\centering
        \includegraphics[width=0.75\textwidth]{tof_corrections}
        \caption{
		Cartoon (not-to-scale) depicting smearing factors in timing reconstruction due to the time of flight of the primary particle, the daughter particle and the scintillation photon.
	}
	\label{fig:tof_corrections}
\end{figure}


%********************************** %First Section  **************************************

\section{Concluding Remarks}

