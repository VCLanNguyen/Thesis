%!TEX root = ../thesis.tex
%*******************************************************************************
%****************************** Third Chapter **********************************
%*******************************************************************************
\chapter{The Short-Baseline Near Detector and Booster Neutrino Beam}
\label{ChapterDetector}
% **************************** Define Graphics Path **************************
\ifpdf
    \graphicspath{{Chapter4/Figs/Raster/}{Chapter4/Figs/PDF/}{Chapter4/Figs/}}
\else
    \graphicspath{{Chapter4/Figs/Vector/}{Chapter4/Figs/}}
\fi

%********************************** %Opening  **************************************

The Short-Baseline Near Detector (SBND) is the near detector of the Short-Baseline Neutrino (SBN) program at Fermilab.
The program is motivated by anomalous results observed across various detectors involving accelerator, nuclear reactor, and solar neutrino experiments.
For instance, the low energy excess in the $\nu_e$ and $\overline{\nu}_e$ interaction measurement observed by both LSND and MiniBooNE experiments is an outstanding anomaly for the past decade \cite{LSND_anomaly, Miniboone_anomaly}.
In addition to being part of the SBN program, SBND also has its own extensive physics program focusing on high precision $\nu$-Ar cross section measurements and physics beyond the Standard Model. 
This will not only benefit future long baseline neutrino experiments such as the Deep Underground Neutrino Experiment but also significantly advance the field of neutrino physics as a whole.
At the time of writing, SBND has entered its commissioning phase, in preparation for calibration and physics data taking.

This chapter contains an overview of the SBND detector and the Booster Neutrino Beam (BNB), which are the detector and beam source used in the search for heavy neutral leptons in this thesis.
The chapter begins with a discussion on the physics program of the SBND experiment in Sec. \ref{sec4PhysicsProgram}. 
Sec. \ref{sec4SBND} provides a detailed description of the detection technology of SBND, covering the time projection chamber, photon detection system, and cosmic ray tagger system. 
This section also elaborates on the hardware triggering system and the data acquisition system employed at SBND.
Finally, an overview of the BNB is presented in Sec. \ref{sec4BNB}, detailing the particle production process of the beam and the flux prediction at SBND.
Finally, Sec \ref{sec:sbnd_conclude} provides some concluding remarks.  

\newpage
%********************************** %First Section  **************************************
\section{The Short-Baseline Near Detector Physics Program}
\label{sec4PhysicsProgram}
%SBN Program

%0: SBND, as part of the SBN Program
%Neutrino Oscillation
The Short-Baseline Near Detector (SBND) is part of the Short-Baseline Neutrino (SBN) Program located at Fermilab \cite{SBNProgram}. 
The program consists of three LArTPC detectors: SBND, MicroBooNE, and Imaging Cosmic Rare Underground Signals (ICARUS), positioned at distances of 110 m, 470 m, and 600 m, respectively, on axis to the target of the Booster Neutrino Beam (BNB) as shown in Fig. \ref{fig:SBN_program}.
The near-far detector setup was designed to search for the potential existence of sterile neutrinos in the mass range of $\mathcal{O}$(1 eV) that was briefly mentioned in Chapter \ref{ChapterHNL}, driven by a series of anomalies observed by previous short baseline experiments.

Amongst these earlier experiments was the Liquid Scintillator Neutrino Detector (LSND) experiment which utilised a stopped pion source to probe $\overline{\nu}_{e}$ via inverse beta decay and reported an excess of signal to the background at low energies with a 3.8$\sigma$ level \cite{LSND_anomaly}. 
The MiniBooNE experiment was a neutrino accelerator experiment to measure the entire phase space covered by the LSND result \cite{Miniboone_anomaly}.
This detector observed an excess of $\nu_{e}$ ($\overline{\nu}_{e}$) in $\nu_{\mu}$ ($\overline{\nu}_{\mu}$) beam mode showing a discrepancy from the SM with a significance level of 4.5$\sigma$ (2.8$\sigma$), reaching 6.0$\sigma$ when combined with the LSND data.
Additionally, a revisit to results from the nuclear reactor experiments indicated a deficit of $\overline{\nu}_{e}$ fluxes to the theoretical expectation at a 3$\sigma$ level \cite{reactor_anomaly_1, reactor_anomaly_2}. 
%and spectral features consistent with an eV-scale sterile neutrino addition \cite{reactor_anomaly_3, reactor_anomaly_4}.
Furthermore, gallium solar neutrino experiments observed an overall deficit in $\nu_{e}$ fluxes at a 3$\sigma$ level during calibrations using radioactive neutrino sources \cite{galium_anomaly_1, galium_anomaly_2}.
These main anomalous results collectively suggest the mass mixing of SM neutrinos with a fourth sterile neutrino at a short baseline to energy ratio of $L/E \approx 1 $ m/MeV, a phenomenon known as eV-scale sterile neutrino oscillation \cite{SBNProgram}.
The goal of the SBN program is to pioneer the search for eV-scale sterile neutrino oscillations, covering the parameter phase space previously allowed by past experiments but at a significance level of $\geq 5 \sigma$.

\begin{figure}[htbp] 
\centering    
\includegraphics[width=1.0\textwidth]{SBN_program}
\caption[Short-Baseline Neutrino Program]{
Graphic showing the three LArTPC detectors made up the Short-Baseline Neutrino program: SBND, MicroBooNE and ICARUS \cite{SBNProgram}.
}
\label{fig:SBN_program}
\end{figure}

%Neutrino Cross Section
Additionally, measurements of $\nu$-Ar interactions play a crucial role in the physics program of SBND, serving as a critical element in understanding neutrino oscillation \cite{NuSTECWhitePaper}. 
Being the nearest to the beam target, SBND is presented with a unique opportunity to observe the largest unoscillated neutrino fluxes among the three detectors.
Over the 3-year operational span, SBND aims to record a staggering 10 million neutrino events, originating from $1 \times 10^{21}$ POT interactions \cite{SBNProgram}.
This will establish SBND as the world leader in statistics for $\nu$-Ar cross section measurements.
More than 6 million $\nu_{\mu}$ Charged Current (CC) events will be collected, reducing the statistical uncertainty to well below the percent level.
Moreover, SBND is expected to record 45,000 $\nu_{e}$ CC events, hence providing the most extensive statistics for both inclusive and exclusive measurements of this channel to date.
These measurements will be extremely beneficial for advancing the objectives of the SBN physics program, as well as contributing to the physics goals of the Deep Underground Neutrino Experiment (DUNE), which employs argon as its target material.

Finally, a key aspect of the physics program at SBND is the exploration of new scenarios leading to Beyond Standard Model (BSM) physics. 
Proximity to a high intensity beam and the resulting large statistics enable searches for very weakly coupled interactions coming from the BNB \cite{SBNProgram}.
%HNL
A key example is Heavy Neutral Leptons (HNLs), the primary focus of this thesis.
These can be produced from the BNB and subsequently decay in flight into SM observables for detection, as previously detailed in Chapter \ref{ChapterHNL}.
%Light Dark Matter
Another compelling BSM candidate is light dark matter, which can be produced from neutral meson decay or proton bremsstrahlung in the BNB \cite{LightDarkMatter}. 
As postulated by thermal relic models, these light dark matter particles could reach sub-GeV-scale masses. 
The particles may scatter and decay, resulting in electromagnetic showers without any hadronic activities inside SBND.
%Dark neutrino
Moreover, the dynamic mass mechanism of neutrinos opens avenues for new physics in the dark sector. 
The dark neutrino model proposes that right-handed neutrinos can scatter with nuclei to produce dark gauge bosons, subsequently decaying into di-lepton pairs \cite{DarkNeutrino}. 
In the case where the leptons are electrons, this could potentially explain the low energy excess anomalies observed by LSND and MiniBooNE \cite{DarkNeutrinoLEE}.
These represent just a few examples of the diverse array of BSM scenarios that can be explored at the SBND detector. 
Other unmentioned possibilities such as new interactions, extra dimensions, and violations of Lorentz and charge parity time symmetries, among others, contribute to the rich physics program of SBND \cite{SBNProgram}.

%********************************** %First Section  **************************************
\section{The Short-Baseline Near Detector}
\label{sec4SBND}

The SBND detector is a LArTPC with an active volume of 112 tons and dimensions of 400 cm (x-drift) $\times$ 400 cm (y-height) $\times$ 500 cm (z-length) \cite{SBNProposal}.
As depicted in Fig. \ref{fig:SBND_Pretty}, the detector consists of two separate TPCs, each with a drift length of 200 cm, sharing a common Cathode Plane Assembly (CPA) positioned at the centre.
On the east and west side of the detector are the Anode Plane Assemblies (APA) made up of three wire planes, and located behind the wires is the Photon Detection System (PDS).
%Additionally, the PDS incorporates a passive component consisting of TPB-coated reflective foils installed at the CPA.
The TPCs are surrounded by a field cage that provides a uniform electric field.
The entire detector is placed inside a membrane cryostat, which is surrounded by 7 walls of Cosmic Ray Tagger (CRT) modules to provide a 4$\pi$ solid angle coverage for cosmic ray rejection.
The following sections provide an overview of each of the main subsystems of SBND.

\begin{figure}[htbp] 
\centering    
\includegraphics[width=0.9\textwidth]{SBND_Pretty}
\caption[Short-Baseline Near Detector 3D Model]{
3D model of the SBND detector, showing the LArTPC surrounded by 4 out of the 7 CRT walls \cite{sbnd_pds_paper}. 
}
\label{fig:SBND_Pretty}
\end{figure}

\subsection{Time Projection Chamber}

Fig. \ref{fig:SBND_APA_diag} shows a diagram of an APA plane that is located on the east and west sides of the SBND detector.
A single APA measures 4 m $\times$ 2.5 m and comprises a steel frame supporting three wire planes: two induction planes, denoted as U and V, oriented at angles of $\pm 60^{\circ}$ to the vertical collection plane denoted as Y. 
These wire planes U, V and Y are colour-coded as green, blue, and red, respectively.
Each wire plane is constructed with 150 $\mu$m diameter copper-beryllium wires, with a wire pitch and plane spacing of 3 mm. 
The wires are tensioned to 7 N to prevent slackening when cooled down to liquid argon temperature at 89 K \cite{SBND_Wires}.
To maintain charge transparency for the induction planes and collection efficiency for the collection plane, a biased voltage of -200 V, 0 V, and 500 V is applied to planes U, V, and Y, respectively.
In total, each TPC consists of 5,632 wires: 1,664 wires in the collection plane and 1,986 wires in each induction plane.

A pair of coupled APAs together form an APA plane, utilising jumper cables to bridge the 15 mm gap between the induction planes to form a single electronic channel. 
Attached to the top, left and right side of an APA plane are the cold electronics readout boards.
They pre-amplify and digitise wire signals while submerged in liquid argon at a low temperature to minimise noise. 
Fig. \ref{fig:SBND_APA} shows a photograph of a fully assembled APA plane at SBND, where the PDS located behind the wires can also be seen.  

\begin{figure}[hb!] 
\centering    
\includegraphics[width=0.65\textwidth]{SBND_APA}
\caption[Anode Plane Assembly Schematic]{
Schematic showing two coupled APAs to form a single APA plane \cite{SBNProposal}.
}
\label{fig:SBND_APA_diag}
\end{figure}

Fig. \ref{fig:SBND_CPA} shows a photograph of the fully assembled CPA.                                                                                                                                 
The plane consists of two steel frames, each containing 8 windows, adding to a total of 16 windows.                                                                                                    
Each window, measuring 60 cm $\times$ 50 cm, houses a fibreglass plate laminated on both sides with non-conductive reflective foils $> 99\%$ specular reflection in the visible range and coated with TPB.                                                                                                                                                                                                    
Furthermore, the plate is covered by a wire mesh, which provides a biased voltage of -100 kV supplied by a high voltage feedthrough donut from outside the cryostat.                                   
                                                                                                                                                                                                       
%Field Cage
The field cage consists of a sequence of electrodes arranged perpendicular to the drift direction.
It can be seen in both Fig. \ref{fig:SBND_APA} and \ref{fig:SBND_CPA} as the series of metal bars surrounding the TPC.
These electrodes incrementally step up the voltage from -100 kV applied at the CPA to the ground voltage in increments of 3 kV. 
This gradual voltage increase is implemented to maintain a uniform electric field of 500 V/cm across the drift volume.

\begin{figure}[htbp!]
%\hfill
\begin{subfigure}[h]{0.5\linewidth}
\centering    
\includegraphics[width=\linewidth]{SBND_APA_PDS}
\caption{View of the APA}
\label{fig:SBND_APA}
\end{subfigure}%
\hfill
\begin{subfigure}[h]{0.5\linewidth}
\centering    
\includegraphics[width=\linewidth]{SBND_CPA}
\caption{View of the CPA}
\label{fig:SBND_CPA}
\end{subfigure}
\caption[SBND Time Projection Chamber Photographs]{
Photographs showing the fully assembled TPC of the SBND detector. 
}
\label{fig:SBND_CPA_APA}
\end{figure}

\subsection{Photon Detection System}
\label{sec:sbnd_pds}

%describe PMT, XARAPUCA and TPB
The PDS design of SBND is the most sophisticated system ever installed in a LArTPC, by incorporating both active and passive optical components \cite{sbnd_pds_paper}. 
The active detector integrates two different technologies: (1) a system of 120 Photomultiplier Tubes (PMTs) and (2) a system of 192 X-ARAPUCA devices.
The PMTs are cryogenic 8"-diameter Hamamatsu R5912-MOD models \cite{hamamatsu}, which are the primary light detection system. 
Meanwhile, the X-ARAPUCAs serve as a research and development platform for future experiments, incorporating multiple variations in their components for performance comparison. 
A summary of the X-ARAPUCA specifications can be found in Ref. \cite{sbnd_pds_paper}.
The TPB-coated reflective foils installed at the CPA are the passive component of the PDS to achieve a uniform light yield.

%PDS Box
Fig. \ref{fig:SBND_PDS} shows a 3D model for each component of the SBND PDS.
For the purpose of installation, the optical detectors are arranged into modular PDS boxes, of which a single PDS box is shown on the left of Fig. \ref{fig:SBND_PDS}.
Each box houses 5 PMTs, 4 coated and 1 uncoated PMT, along with 8 X-ARAPUCA devices, 4 coated and 4 uncoated.
These PDS boxes are installed in a configuration of $4 \times 3$ behind each APA plane as illustrated on the right of Fig. \ref{fig:SBND_PDS}.
This results in a total of 12 boxes per TPC volume.
The TPB-coated reflective foils at the central cathode can also be seen on the right of Fig. \ref{fig:SBND_PDS}.

\begin{figure}[hbp]
\centering    
\includegraphics[width=0.85\textwidth]{SBND_PDS}
\caption[Photon Detection System 3D Model]{
3D model of a PDS box (left) and the PDS box arrangement on the east and west side of the TPC (right) \cite{sbnd_pds_paper}.
}
\label{fig:SBND_PDS}
\end{figure}

Out of the two optical detectors, PMT signals are the primary light signals and are used to provide trigger conditions.
The 120 PMTs are partitioned into two optically-isolated TPC volumes, each with 60 PMTs.
Within each TPC, 48 PMTs are TPB-coated, and thus are sensitive to both direct and reflected light components, while the remaining 12 non-coated PMTs detect only reflected light. 
This ratio of coated to uncoated PMTs (4:1) is chosen to optimize light collection efficiency while maintaining the capability to distinguish between the two light components \cite{sbnd_pds_paper}. 
Such differentiation significantly improves the timing reconstruction using only PMT signals, which will be further discussed in Sec. \ref{sec:reco_pds}.

\subsection{Cosmic Ray Tagger}
\label{sec:sbnd_crt}

Since SBND is a surface detector, it utilises a Cosmic Ray Tagger (CRT) system to effectively reject background from cosmic rays.                                                         
Fig. \ref{fig:SBND_CRT} shows the operating principles of CRT strips and their orientation.                                                                                                 
As shown in the middle diagram, each CRT strip consists of a plastic scintillator strip with a width of 10.8 cm, connected to a pair of SiPMs via wavelength shifting optical fibres.       
The right diagram shows a coincident hit from perpendicular strips that allows for a 2D reconstruction of the hit location, and the number of photons collected for each strip improves the precision of the location tagging.                                                                                                                                                                     
16 scintillator strips in parallel form a CRT module.                                                                                                                                       
Multiple CRT modules are arranged orthogonally to form a CRT wall, typically in the size of 7.5 m in height and 9 m in width.                                                                  
The left diagram shows an example orientation of 2 CRT modules on top of each other, where CRT strips of each module are perpendicular to each other.                                       
%Signals from the SiPMs are amplified, digitised and read out by the Front End Board (FEB) modules with nanosecond timing resolution, which will be detailed in Sec. \ref{}.                 
                                                                                                                                                                                            
The cryostat of SBND is entirely encased by 7 CRT walls, with 1 on each side and 2 positioned on top of the detector.                                                                       
Fig. \ref{fig:SBND_Pretty} shows 4 out of the 7 CRT walls, particularly the south, west and top walls are visible.                                                                          
Additionally, the top 2 walls function as a telescopic array, facilitating the tagging of vertical downward going cosmic rays.
This configuration enables a comprehensive strategy for cosmic background rejection utilising both geometrical and high precision timing information, which will be more detailed in Sec. \ref{sec:crumbs}.
%For instance, tracks identified by the TPC can be matched to CRT hits to identify tracks occurring outside the beam spill window.

\begin{figure}[hb!] 
\centering    
\includegraphics[width=1.0\textwidth]{SBND_CRT}
\caption[Cosmic Ray Tagger Diagrams]{
Diagrams showing the operating principles of CRT strips (middle, right) and their perpendicular orientation (left) \cite{RhiannonPhD}.
}
\label{fig:SBND_CRT}
\end{figure}

\subsection{Readout Electronics}
\label{sec:readout}

%Cold Electronic
The readout electronics of each detection subsystem, TPC, PDS and CRT, are detailed next.
Firstly, TPC readouts comprise four components: (1) Cold Electronics (CE), (2) Warm Interface Boards (WIBs), (3) TPC crates and (4) Nevis Trigger Board (NTB).%, shown as the red boxes from left to right respectively in Fig. \ref{fig:daqOverview}.
Previously depicted in Fig. \ref{fig:SBND_APA_diag}, the wires are connected to CE readout boards on the APA plane.
Located inside the cryostat, the CE components are submerged in liquid argon to reduce thermal noise as well as cable lengths \cite{SBND_CE}.
They are responsible for amplifying and digitizing waveform signals at a sampling frequency of 2 MHz. 
Signals from the CE are sent outside of the cryostat to the WIBs via copper cold cables.              
The WIBs serve as a bridge between the CE and other TPC readouts through fibre optic links.
This isolation architecture ensures the complete separation of wire grounding from the building, therefore resulting in a superior signal-to-noise ratio.

%Nevis Readout
Following the WIBs, the data is transmitted to 11 TPC crates for reading out, buffering, and processing the wire signals. 
Data from TPC readout crates are directed by the NTB, separating two parallel independent streams of TPC data.
%The main stream to record neutrino beam events relies on the ETRIG trigger signal from the PTB for triggering as previously detailed in Sec. \ref{sec:sbnd_trigger}, which reads out data with lossless compression.
The main stream to record neutrino beam events relies on an external trigger, which reads out data with lossless compression.
An additional continuous stream requires no external triggers and outputs data with lossy compression. 

%CAEN digitizer
Regarding the electronics readouts of the PDS next, they are the commercial CAEN digitizers. % depicted as the blue boxes in Fig. \ref{fig:daqOverview}
120 PMTs are readout by 8 CAEN V1730SB digitizers \cite{caen1730}, which are capable of recording waveforms for 16 channels independently with a sampling frequency of 500 MHz.
Meanwhile, the 192 X-ARAPUCAs are digitised by another model called V1740 \cite{caen1740}, that can readout 64 channels at a lower sampling frequency of 62.5 MHz.              
Both of these models feature deep buffers to store longer waveforms and handle higher data rates.
Additionally, the V1730SB model offers better waveform baseline stability against temperature fluctuations.
Multiple CAEN digitizers can be synchronised such that they collectively behave as a single digitizer, which is critical to maintaining the timing resolution of the electronics at $\mathcal{O}$(1 ns).
The characterisation of synchronisation across multiple V1730SB digitizers is detailed in Sec. \ref{sec4PMT}.

%The timing resolution of the CRT readout electronics is evaluated in the following section.
%CRT FEB
Finally, the 7 CRT walls are read out by 144 Front End Board (FEB) modules \cite{crt_note}.%, as shown by the orange box in Fig. \ref{fig:daqOverview}.
Each FEB module is a multifunctional board capable of reading out 32 channels, with one channel per SiPM. 
The module can provide a bias voltage, which is adjustable for individual SiPM, as well as signal amplification and shaping.
Once the signal is shaped, the FEB can apply signal discrimination and self-triggering, such as coincidence for each pair of SiPMs in a CRT strip or coincidence across multiple FEBs for orthogonal CRT strips. 
Once the signal passes the trigger, it is digitised and timestamped with respect to an input reference clock. 
The data is then stored in a buffer and read out via an Ethernet connection. 
The characterisation of the timing resolution of FEB modules is detailed in Sec. \ref{sec4InternalClock}
%The following section focuses on the characterisation on the timing resolution of the FEB module.

\subsection{Hardware Trigger}
\label{sec:sbnd_trigger}

Triggering plays a vital role in the SBND detector to select only interesting physics events, given the detector is exposed to a high rate of backgrounds from cosmic rays. 
The main hardware trigger component in SBND is the Penn Trigger Board (PTB).
It applies a programmable trigger logic based on external inputs and issues a trigger to the Data AcQuisition (DAQ) subsystem if the conditions are met.
Details of the hardware trigger at SBND can be found in Appendix \ref{appendix_hardware_trigger}, while a short summary is provided here.

In order to form a trigger, the PTB requires signals from the three subsystems: (1) beam system, (2) PMTs, and (3) CRTs.
The beam system informs the PTB on the status on the BNB beam, and whether the beam has arrived at the detector hall.
Signals from PMTs provides information regarding the intensity and locality of the energy deposited inside the detector, and whether it is consistent with a neutrino event.
Signals from CRTs provides geometrical information of the energy deposited outside of the detector in the CRT walls, and whether it is consistent with a cosmic muon. 
The readout electronics of PMTs and CRTs are equipped with timing resolution $\mathcal{O}$(1 ns) and their output signals can quickly inform the PTB to form a trigger.
Additionally, incorporating CRT signals marks SBND as the first instance of a LArTPC to employ CRTs as part of its triggering scheme \cite{CPAD2022}.

Different combinations of signal inputs described here can form different \textit{flavours} of triggers.
%The primary beam trigger requires majority triggers from PMTS and threshold crossings from MTC/A to coincide with the beam early warning signal.
The primary beam trigger PMT signals to coincide with the beam early warning signal.
Conversely, for background estimation purposes, an anti-coincidence to the beam signal logic can be applied to select cosmic rays occurring outside of the beam spill window.
The calibration trigger utilises coincidence across different CRT walls to select cosmic tracks of specific topologies.
For example, anode-to-cathode-crossing cosmic tracks can be selected by requiring the east and west CRT walls to be coincident.
These sets of tracks are useful for electron lifetime measurements, which will be explored in Sec. \ref{sec7:etime}.

The key information about the hardware triggering at SBND is that for a single triggered physics event, it constitutes of two types of triggers: (1) a single Event TRIGger (ETRIG) issued to the TPC readouts and (2) multiple Flash TRIGgers (FTRIGs) issued to the PDS readouts.
The ETRIG is used by the DAQ subsystem to acquire a long snapshot of the TPC waveform $\mathcal{O}$(1 ms) while multiple FTRIGs are used to capture many short snapshots of optical detector waveforms $\mathcal{O}$(10 $\mu$s).
The data is then assemble to build a physics event, of which the process will be explained in Sec. \ref{sec4DAQOverview} and \ref{sec:evb} next.

\subsection{Data Acquisition}
\label{sec4DAQOverview}

Upon receiving a hardware trigger, the DAQ subsystem begins to transport data from subsystem readouts to event builder machines. 
The SBND DAQ can assemble data from each subsystem into a physics event during real time data flow, known as the event building process.
It must also be able to handle a high event rate due to the close proximity of SBND to the beam target.
Additionally, the DAQ can apply software metrics to filter events for various data streams and data monitoring purposes.

Fig. \ref{fig:daqOverview} shows the data flow of the DAQ at SBND.
The data flow begins with raw signals from detection subsystems, shown as the coloured dotted arrows.
The signals are acquired by readout electronics, shown as colour boxes in the first column labelled \textit{Readout Electronics}, that was covered earlier in Sec. \ref{sec:readout}.
The boxes are colour-coded as red, blue and orange for the TPC, PDS and CRT readout respectively.
Within this first column, 2 additional readout electronics are also included.
The Penn Trigger Board, shown by the green box, is for the hardware triggering subsystem.
The White Rabbit SPEC-TDC, shown by the purple box, is part of the White Rabbit timing subsystem and will be discussed in detail in Chapter \ref{ChapterDAQ}.

\begin{figure}[b!] 
\centering    
\includegraphics[width=1.0\textwidth]{DAQ_Overview}
\caption[Data Acquision Flow Chart]{
Flow chart showing the data flow of data acquisition.
}
\label{fig:daqOverview}
\end{figure}

Each of the readout electronics components is accompanied by a corresponding \textit{boardreader}, shown by the second column labelled \textit{Servers Hosting Boardreaders}.
Boardreaders are software tools serving as a communication bridge between readout electronics and computer servers.
There is a two-way communication between readout electronics and boardreaders.
The electronics send raw signals to the computer servers hosting boardreaders, shown as the grey dotted arrows.
The software boardreaders in return send configurations to the electronics, shown as the grey dashed-dotted arrows.

The event building process occurs in the third column labelled \textit{Event Builder Machines}.
The raw signals are packaged into a data format known as \textit{fragments} by boardreaders.
The fragments are sent to event builders, as shown by the coloured solid arrows.
The event builders assemble fragments from different readout electronics into physics events.
The event building process will be discussed next in Sec. \ref{sec:evb}.
                        
Finally, the fourth column labelled \textit{Data Stream} illustrates the last stage of the data flow.
Software metrics can be applied by event builders to separate physics events into different streams of data, as shown by the grey dashed arrows.
This assists with data management since different flavours of triggered events can be organised into different locations.
An additional data stream for online monitoring is shown by the bottom right grey box.
Details of the data streaming process is provided in Appendix \ref{appendix_data_stream}.

%Each detection subsystem incorporates specialized hardware components for digitizing and reading out the physical signals. 
%The PTB, as a hardware board within the SBND trigger system, is responsible to provide triggering signals to each detection subsystem independently.
%The SPEC-TDC is a specialised timing mezzanine module designed specifically for timestamping purposes.
%Further details about its functionality are outlined in section \ref{subsec42TimeRef}.

\subsection{Event Building}
\label{sec:evb}

With the various sources of detection signals established as above, the next step in the DAQ is to build a physics event.
This is achieved by using a DAQ software framework provided by the artdaq Toolkit, developed by the Real-Time Systems Engineering Department of Fermilab's Scientific Computing Division \cite{artdaq_note}. 
This software serves as the backbone for communication between the hardware electronics and the event builder machines.

Within the artdaq framework, each discrete hardware readout component has a corresponding software module known as a \textit{boardreader}.
These boardreaders facilitate communication between the readout electronics and the event builder machines. 
They can send configurations directly to the hardware in one direction and retrieve data from the hardware in the opposite direction.
Data acquired from the readouts is packaged by boardreaders into a digitised format called a \textit{fragment}.
Technical details of boardreaders and fragments can be found in Ref. \cite{artdaq_note}.
In the scope of this work interested in the timing aspect of the DAQ that will be elaborated in Chapter \ref{ChapterDAQ}, the critical information of a fragment is its timestamp corresponding to when the readout electronics receive a trigger.

%, as depicted in Fig. \ref{fig:fragmentDiagram}. 
%The fragment class consists of a header containing experiment-specific information essential for event building, an optional metadata, and a data payload storing the hardware-defined data.
%A fragment is generated by the boardreader when its corresponding hardware readout receives a trigger.
%The timestamp of the trigger arrival is encoded as the fragment timestamp. 
%This timestamp is a crucial piece of information for the event building process.

%\begin{figure}[tbp!] 
%\centering    
%\includegraphics[width=0.6\textwidth]{Fragment_Diagram}
%\caption[FragmentDiagram]{
%Diagram illustrating the fragment class defined by the \textit{artdaq Toolkit}. 
%The header contains the crucial fragment timestamp information needed for event building.  
%%Optionally, the metadata structure contains hardware configurations. 
%%The payload is designated for storing data from the hardware readout, of which the data structure is pre-defined by the hardware. 
%}
%\label{fig:fragmentDiagram}
%\end{figure}


%what is push/pull

%Once fragments are generated, boardreaders can send them to the event builders in one of two configurations: (1) push or (2) pull.
%In the push configuration, the boardreader actively sends fragments continuously at the rate at which the fragments are generated. 
%With each fragment sent, the push boardreader also creates a request message, which is multicast to all other boardreaders currently in pull mode. 
%This request message contains the timestamp of the push fragment.
%The sequence ID of the fragments determines the sequence ID of the built event, ensuring  that every fragment is built as a single event.

%In contrast to the push configuration, the boardreader in the pull configuration stores the fragments in its buffer as they are being generated. 
%These fragments are sent to the event builders only upon receiving a request message.
%The pull boardreader checks its buffer and selects the fragments with timestamps falling within a specified time window of the request message, known as a \textit{pull window}.
%It then dispatches these selected fragments to the event builders. 
%Subsequently, the event builder machines assemble this set of pull fragments, together with the one push fragment that initially generated the request message, into a single event.
%To determine which fragments to send, the boardreader has a configurable parameter called pull window, which specifies a time window relative to the timestamp of the request message.
%The pull boardreader checks its buffer and selects the fragments with timestamps falling within this defined time window.
%The selected fragments that meet the timestamp requirement are then dispatched to the event builders.
%The sequence ID of the resulting event is determined by the push fragment.

\begin{figure}[htbp!] 
\centering    
\includegraphics[width=1.0\textwidth]{SBND_Event_Structure}
\caption[Chronological Structure of a Physics Event Diagram]{
Diagram depicting the chronological structure of a physics event. 
}
\label{fig:SBNDEventStructure}
\end{figure}

Event builders assemble fragments from different readouts into a physics event based on their timestamps.
Fig. \ref{fig:SBNDEventStructure} illustrates the chronological structure of a physics event at SBND, containing only TPC, PMT and CRT fragments for simplicity.
The time axis is shown as the purple arrow, where at the centre $t = 0$ ms corresponds to when the beam spill begins.
The TPC fragment, as shown in red, is coincident with the beam spill to capture the neutrino event in the TPC. 
The readout length of a TPC fragment is 1.7 ms, covering the entire TPC drift length of 1.3 ms and including a padding of 0.2 ms before and after the drift. 
Aligning the TPC fragment with the beam spill is achieved through the ETRIG trigger issued to the TPC readouts such that it coincides with when the beam spill begins.

%describe an event structure
%A neutrino beam event at SBND is structured as outlined in Fig. \ref{fig:SBNDEventStructure}, with examples provided for TPC, PMTs, and CRTs fragments.
%The PTB first sends a single ETRIG to the NTB that coincides with the start of the BNB beam spill if it determines a neutrino event occurs. 

%The ETRIG timestamp is encoded in the NTB fragment header.
%The NTB boardreader operates in push configuration, thus driving the data acquisitions of the PMT and CRT readouts in pull configuration.
%Within this structure, there is only one push boardreader that increments the event sequence ID counter whilst the remaining boardreaders run in pull configuration.
%The push boardreader is called the Nevis Trigger Board (NTB), which is a component of the hardware complex to readout the TPC data. 

%Meanwhile, the boardreaders for the PMTs and CRTs are in pull mode.
Moreover, PMT and CRT fragments are shown in blue and orange respectively in Fig. \ref{fig:SBNDEventStructure}.
The fragment readout lengths from the PMT and CRT readouts are much shorter compared to TPC fragments, $\mathcal{O}(10\ \mu$s) and $\mathcal{O}(10$ ns) respectively.
For a single physics event, in contrast to only a single ETRIG issued to the TPC readouts, multiple FTRIGs are issued to the PMT readouts throughout the beam spill to produce multiple fragments of PMTs.
Similarly, CRT readouts are self-triggered independently and produce multiple fragments on the flight.
PMT and CRT fragments that have timestamps within 1.5 ms before and after the beginning of the beam spill are packaged together with the TPC fragment to form a physics event.

%The pull window is defined to be 3 ms centred on the timestamp of the NTB fragment. 
%This window includes PMT and CRT fragments generated 1.5 ms before and after the beam spill starts. 

%event asymmetry
Here in Fig. \ref{fig:SBNDEventStructure}, a time symmetry can be seen in the chronological structure of a physics event at SBND.
This is due to the different physics characteristics of photon signals, detected by the CRTs and PMTs, and electron signals, detected by the TPC wires. 
Specifically, a photon produced in a CRT scintillator strip takes approximately 5 ns to travel from the far end of the strip until reaching a SiPM. 
Similarly, a photon produced in the TPC takes a maximum of 15 ns to propagate from a scintillation location to a PMT.
In contrast, an ionisation electron produced takes 1.3 ms to fully drift from the cathode to the anode.
This shows that photon signals propagate approximately six orders of magnitude faster than electron signals and consequently, need to be digitised and read out earlier.
%The time asymmetry of the event structure is due to scintillation photon signals propagating faster compared to electron signals.


%********************************** %First Section  **************************************
\section{The Booster Neutrino Beam}
\label{sec4BNB}

%Describe rate
The SBND detector directly measures the neutrino flux coming from the BNB.                                                                                                                  
Comprehensive technical details of the BNB can be found in Ref. \cite{BNBMiniBooNE}.                                                                                                      
The BNB operates by extracting protons with a kinetic energy of 8 GeV from the Booster synchrotron in spills made up of 7 to 11 pulses in a row at a frequency of 15 Hz, averaging to a rate of $\sim$5 Hz.                                                                                                                                                                                        
Each spill delivers $5 \times 10^{12}$ protons within a beam spill window lasting 1.6 $\mu$s.                                                                                               
The structure of a beam spill structure consists of 81 neutrino buckets, with a Gaussian width of 1.308 ns and a spacing of 19 ns \cite{BNBsigma}.                                          
Fig. \ref{fig:CRT2017} depicts the beam bucket structure as measured by the CRTs of SBND, which was set up as a beam telescope to collect data from the BNB in 2017--2018 \cite{CPAD2022}.                         
Neutrino buckets can be seen distinctively in the distribution, indicating that the BNB structure can be resolved with sufficient timing resolution.                              
The timing resolution of the CRT readouts is $\mathcal{O}$ (1 ns), which will be demonstrated later in Sec. \ref{sec4InternalClock}.

\begin{figure}[b!] 
\centering    
\includegraphics[width=0.85\textwidth]{CRT2017}
\caption[BNB Beam Bucket Measured By SBND CRTs in 2017-2018]{
Plot showing the BNB beam bucket measured by the CRTs of SBND during 2017--2018 \cite{CPAD2022}.
}
\label{fig:CRT2017}
\end{figure}

%hardware structure
The particle production process in the BNB is illustrated in Fig. \ref{fig:BNBDiagram}.
Initially, protons are injected into the Booster synchrotron and accelerated from 400 MeV to 8 GeV kinetic energy, as shown by the red arrows. 
Their intensity is measured by two steroids, while their positioning and timing are monitored by beam position monitors and Resistive Wall Monitor (RWM) \cite{BNBRWM}.
Upon exiting the Booster, the proton beam traverses focusing and defocusing quadrupole and dipole magnets before being focused onto the target of the BNB.

The protons collide on the target to produce secondary mesons, as shown by the blue arrows.
The target consists of a beryllium cylinder measuring 71.1 cm in length and 0.51 cm in radius.
The choice of beryllium was motivated by its replaceable ability in the event of radioactivity issues, as well as its ability to facilitate sufficient energy loss via an air cooling system.
The target is placed inside a pulsed horn system, which acts as a 170 kA electromagnet to focus the secondary mesons.
The polarity of the horn can be adjusted to focus positive (negative) mesons for operation in neutrino (antineutrino) mode. 
%Downstream of the horn assembly, a concrete collimator of dimensions 214 cm in length and 30 cm in radius (expanding to 35.5 cm from upstream to downstream end) absorbs particles that do not contribute to the neutrino flux, thereby reducing radiation elsewhere in the beamline.
Downstream of the horn assembly, a concrete collimator absorbs particles that do not contribute to the neutrino flux, thereby reducing radiation elsewhere in the beamline.

The focused mesons then propagate through an air-filled cylindrical decay region spanning 45 m, depicted as the orange box.
It is then terminated by a steel and concrete absorber located 50 m from the upstream face of the target, depicted as the purple box.
Secondary mesons decay into tertiary neutrinos within the decay region, while long-lived muons are absorbed by the absorber. 
Subsequently, tertiary neutrinos traverse through a dirt region before reaching the SBND detector, as shown by the pink arrows.
The production of HNLs from kaon decays alongside neutrinos is also shown as the purple arrow.

\begin{figure}[b!] 
\centering    
\includegraphics[width=1.0\textwidth]{BNBDiagram}
\caption[Particle Production in the BNB Diagram]{
Diagram showing the particle production in the BNB.
}
\label{fig:BNBDiagram}
\end{figure}

%beam simulation
%Explain what meson is in the flux, what tuning is used, 
The beam is simulated using GEANT4 with different tunings for the composition of the secondary mesons and hadrons produced from $p + Be$ interactions \cite{BNBMiniBooNE}.
The $\pi^{\pm}$ production is tuned to the HARP data set using Sanford-Wang parametrisation.
The $K^{+}$ production is extrapolated to the global $K^{+}$ production data using Feynman scaling-based parametrisation, and further constrained by SciBooNE's direct measurements of $K^{+}$ production from the BNB \cite{SciBooNE}. 
Other secondary hadrons and mesons such as $p$, $n$ and $K^{-}$ are modelled using the MARS hadronic interactions, however, their overall contribution to the neutrino flux is small. 
Interaction cross sections of $p/n + Be$ and $\pi^{\pm} + Be$ are also incorporated in flux predictions \cite{DavePhd}.   
%The systematics uncertainties associated with the BNB flux are calculated by a re-weighting process, which will be presented in Chapter \ref{ChapterResult}.

Fig. \ref{fig:BNB_Meson_Flux} depicts the primary contributors to the secondary meson fluxes at the BNB, namely pions and kaons.
A small fraction of muons resulting from pion decays also contribute to the fluxes.
These fluxes are shown for the BNB operating in neutrino mode, mainly composed of positively charged mesons.
As discussed in Sec. \ref{sec2Production}, the flux of HNL comes from $K^{+}$ decays, which has energy peaking at $0.5 \sim 1$ GeV.
Ref \cite{BNBMiniBooNE} has highlighted significant uncertainties in the $K^{+}$ production cross sections within this energy range.
However, results from the SciBooNE experiment have demonstrated the validity of extrapolating higher energy $K^{+}$ data to the 1 GeV region using Feynman scaling \cite{SciBooNE}. 

\begin{figure}[h!]
\begin{subfigure}{.5\linewidth}
\centering
\includegraphics[width=1.0\textwidth]{BNB_Meson_Pion_Flux}
%\caption{}
%\label{fig:sub1}
\end{subfigure}%
\begin{subfigure}{.5\linewidth}
\centering
\includegraphics[width=1.0\textwidth]{BNB_Meson_Kaon_Flux}
%\caption{}
%\label{fig:sub2}
\end{subfigure}\\[1ex]
\begin{subfigure}{\linewidth}
\centering
\includegraphics[width=0.5\textwidth]{BNB_Meson_Muon_Flux}
%\caption{}
%\label{fig:sub3}
\end{subfigure}
\caption[Secondary Mesons in the BNB Fluxes]{
Simulated fluxes for the secondary mesons produced in the BNB. 
}
\label{fig:BNB_Meson_Flux}
\vspace{0.5cm}
\end{figure}

The simulation of the neutrino flux at the front face of SBND is depicted in Fig. \ref{fig:BNB_combined_neutrino_flux}, shown for different flavours of neutrinos. 
The flux is predominantly composed of $\nu_{\mu}$ ($\sim90\%$), followed by $\bar{\nu}_{\mu}$ ($\sim9\%$), while the combination of $\nu_{e}$ and $\bar{\nu}_{e}$ contributes less than 1\%.
Fig. \ref{fig:BNB_neutrino_flux} depicts the parent mesons for each neutrino flavour.
Pion production is the dominant mechanism for both $\nu_{\mu}$ and $\bar{\nu}_{\mu}$, followed by kaon and muon production. 
Notably, a peak in the $\nu_{\mu}$ flux can be seen at half the mass of the kaon (235.5 MeV) resulting from kaon decay at rest \cite{kaonDecayNu}.
In the case of $\nu_{e}$, muons produced from pion decay are the primary source at low energies, while kaon production becomes the dominant mode at higher energies. 
Finally, $\bar{\nu}_{e}$ mainly originates from $K^{0}_{L}$ production.

\begin{figure}[hb!] 
\centering    
\includegraphics[width=0.5\textwidth]{BNB_combined_neutrino_flux}
\caption[Siumluated Neutrino Fluxes at the Front Face of SBND]{
Simulated neutrino fluxes at the front face of SBND. 
}
\label{fig:BNB_combined_neutrino_flux}
%\end{figure}
%\begin{figure}[h] 
\vspace{0.5cm}
\centering    
\includegraphics[width=1.0\textwidth]{BNB_neutrino_flux}
\caption[Simulated Neutrino Fluxes Of Different Flavours at the Front Face of SBND]{
Simulated fluxes of different neutrino flavours at the front face of SBND, broken down into types of parent mesons.
}
\label{fig:BNB_neutrino_flux}
\end{figure}

%********************************** %First Section  **************************************
\section{Concluding Remarks}
\label{sec:sbnd_conclude}

The SBND experiment, together with other experiments in the SBN program, aims to conclusively address the low energy excess observed across experiments such as LSND, MiniBooNE, and others, including nuclear reactor and solar neutrino experiments. 
SBND will play a crucial role in constraining systematic uncertainties by measuring large statistics of the unoscillated neutrino flux from the BNB.
Additionally, SBND has a rich physics program covering neutrino cross section measurements and searches for BSM physics. 
Of particular relevance to this thesis, SBND aims to establish competitive limits on the mixing of HNLs within the probable mass range from the BNB.

The hardware of SBND comprises three key detection subsystems: the TPC, the PDS, and the CRT system, alongside the hardware triggering subsystem. 
Each of these subsystems has dedicated readout electronics, which are managed by a complex DAQ system.
The SBND detector measures the flux coming from the BNB, which has a distinctive bucket structure which can be resolved with a sufficient timing resolution $\mathcal{O}$(1 ns). 
This feature can be exploited in the search for HNLs at SBND since the mass of HNLs results in late arrival at the detector compared to the neutrino buckets. 
The following Chapter \ref{ChapterSim} will delve into SBND's simulation framework that enables the exploration of the detector physics capabilities in the BSM regime.  

%The event building process of the DAQ relies on the timing information acquired from each subsystem. 
%This process assembles the foundation of physics event upon which low-level and high-level reconstructions are built to achieve nanosecond timing resolution.
%The timing characterisation of the readout electronics will be discussed in the forthcoming chapter.
